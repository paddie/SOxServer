{{define "machinelist"}}
{{template "base_top"}}
{{template "topbar"}}

<div class="container-fluid"><div class="page-header">
  <h1>Active machines <small>Click the headers to sort them by the different attributes</small></h1>
</div>
  <section id="tables">
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          {{range .Headers}} <th>{{if .Key}}<a href="/?sortkey={{.Key}}">{{.Name}}</a>{{else}}{{.Name}}{{end}}</th>{{end}}
        </tr>
      </thead>
      <tbody>
        {{range .Machines}}
          <tr onclick="window.document.location='/machine/{{.Id}}';" {{ if .SoxIssues }} class="error" {{else}} {{if .SoxWarning}} class="warning" {{end}} {{end}}>
            <td><font size="2">{{.Cnt}}</font></td>
            <td>
              {{ if .NameLengthIssue }} 
              <span class="label label-important">
                {{.Hostname}}
              </span>
              {{else}}
                {{.Hostname}}
              {{end}}
            </td>
            <td>{{.Ip}}</td>
            <td>{{.Osx}}</td>
            {{if .Softwareupdate}}<td><font size="2"><span class="label label-warning">Pending updates {{if .SecurityUpdate}} <i class="icon-warning-sign"></i>{{end}}</span></font></td>{{else}}<td><font size="2">None</font></td>{{end}}
            {{if .Recon}}<td><font size="2">Installed</font></td>{{else}}<td><font size="2"><span class="label label-important">Missing</span></font></td>{{end}}
            {{if .Firewall}}
              <td><font size="2">On</font></td>
            {{else}}
              {{if .FirewallIssue}}
                <td><font size="2"><span class="label label-important">Off</span></font></td>
              {{else}}
                <td><font size="2">Off</font></td>
              {{end}}
            {{end}}
              {{if .AntivirusIssue}}
                <td><font size="2"><span class="label label-important">Missing</span></font></td>
              {{else}}
                <td><font size="2"> {{.Virus_version}} ({{.Virus_def}})</font></td>
              {{end}}
            <td><font size="2">
                {{if .IsAncient}}
                <span class="label label-important"> {{.Date}} </span></font></td>
                {{else}}
                  {{if .IsOld}} 
                    <span class="label label-warning"> {{.Date}} </span></font></td>
                  {{else}}
                    {{.Date}}
                  {{end}}
                {{end}}</font></td>
            <td><font size="2">{{.Model}}</font></td>
            <td><font size="2">{{.Memory}}</font></td>
            <td><font size="2">{{.Script_v}}</font></td>
            <td><a href="/del/{{.Id}}"><font size="2">Delete</font></a></td>
          </tr>
        {{end}}
      </tbody>
    </table>
  </section><!-- tables -->
</div> <!-- container -->
{{template "base_bottom"}}
{{end}}